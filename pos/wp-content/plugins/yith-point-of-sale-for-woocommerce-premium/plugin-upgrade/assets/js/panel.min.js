!function(t){"use strict";if("undefined"==typeof yithLicenceData)return void console.error("Missing required YITH licence deps");({init:function(){t(document).on("click",".yith-licence-where-find-these",this.toggleWhereToFindModal.bind(this)),t(document).on("submit",".yith-licence-activation-form",this.handleActivation.bind(this)),t(document).on("focusout",".yith-licence-activation-form :input",this.checkActivationInput.bind(this)),t(document).on("click",".yith-plugin-fw__action-button--delete-action",this.handleDeactivation.bind(this))},isEmail:function(t){return new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(t)},isLicenceKey:function(t){return new RegExp(/^[a-zA-Z0-9]{8}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{12}$/g).test(t)},doAjaxRequest:function(t,e){return(t=t||[]).push({name:"action",value:yithLicenceData.ajaxAction},{name:"security",value:yithLicenceData.ajaxNonce},{name:"yith-license-debug",value:-1!==location.search.indexOf("yith-license-debug")}),jQuery.ajax({type:"POST",url:yithLicenceData.ajaxUrl,data:t,dataType:"json",beforeSend:function(){e.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}}).fail(((t,i,n)=>{console.error(i+": "+n),e.unblock()}))},addActivationRow:function(e){e=t(e),t(e).addClass("activated"),t(".yith-licence-header").show().after(e),setTimeout((function(){e.removeClass("activated")}),5e3),window.scrollTo({top:e.position().top-100,behavior:"smooth"})},addActivationFormRow:function(e){e=t(e),t(".yith-licences-list").append(e),t(".yith-licence-activation").length||t(".yith-licence-header").hide()},toggleWhereToFindModal:function(t){t.preventDefault(),yith.ui.modal({title:yithLicenceData.modal.title,content:yithLicenceData.modal.content,footer:yithLicenceData.modal.footer,width:960,allowWpMenu:!1,closeWhenClickingOnOverlay:!0,classes:{title:"yith-license-modal-title",content:"yith-license-modal-content",footer:"yith-license-modal-footer"}})},addInputError:function(e,i){t(e).next(".yith-licence-error-message").length||t(e).after('<span class="yith-licence-error-message" />'),t(e).next(".yith-licence-error-message").html(i)},removeInputError:function(e){t(e).next(".yith-licence-error-message").remove()},checkActivationInput:function(e){const i=t(e.target),n=t(i).attr("name");this.isActivationInputValid(i)?this.removeInputError(i):this.addInputError(i,yithLicenceData.errors[n]),this.isActivationFormValid(i.closest("form"))},isActivationInputValid:function(e){const i=t(e).attr("name"),n=t(e).val()?.trim();return n&&"email"===i&&this.isEmail(n)||"licence_key"===i&&this.isLicenceKey(n)},isActivationFormValid:function(e){const i=t(e).find('input[type="submit"]'),n=!t(e).find('input[type="text"]').filter(((t,e)=>!this.isActivationInputValid(e))).length;return n?i.removeAttr("disabled"):i.attr("disabled",!0),n},handleActivation:function(e){e.preventDefault();const i=this,n=t(e.target);if(!i.isActivationFormValid(n))return!1;let a=n.serializeArray();a.push({name:"request",value:"licence_activation"}),i.doAjaxRequest(a,n).done((t=>{t?.success?(n.remove(),i.addActivationRow(t.data.html)):(n.unblock(),i.addInputError(n.find('[name="licence_key"]'),t.data.message))}))},handleDeactivation:function(e){e.preventDefault();const i=this,n=t(e.target).closest(".yith-licence-activation"),a=n.data("product");yith.ui.confirm({title:yithLicenceData.deactivationConfirmTitle,message:yithLicenceData.deactivationConfirm.replace("{{plugin_name}}","<strong>"+n.find(".yith-licence-product").text()+"</strong>"),confirmButtonType:"delete",onConfirm:function(){i.doAjaxRequest([{name:"request",value:"licence_deactivation"},{name:"product_init",value:a}],n).done((t=>{t?.success?(n.remove(),i.addActivationFormRow(t.data.html)):n.unblock()}))}})}}).init()}(jQuery);